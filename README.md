
# ๐ Appointment Reservation System API

## ๐ฏ ูุนุฑู ูพุฑูฺู
ุงู ูพุฑูฺู ฺฉ **API ุณุณุชู ุฑุฒุฑู ููุจุช** ุงุณุช ฺฉู ุจุง **ASP.NET Core** ู ุจุฑ ุงุณุงุณ ุงุตูู **Clean Architecture** ุทุฑุงุญ ู ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช.

ุชูุฑฺฉุฒ ุงุตู ูพุฑูฺู ุจุฑ:
- โ ุงููุช ูุจุชู ุจุฑ JWT
- โ ุทุฑุงุญ RESTful ูุงูุน
- โ ุฌุฏุงุณุงุฒ ูุณุฆููุชโูุง
- โ ุฌููฺฏุฑ ุงุฒ ุงุฑุณุงู ู ุฏุณุชฺฉุงุฑ ุดูุงุณู ฺฉุงุฑุจุฑ
- โ ุงุนูุงู Authorization ุฏุฑ ูุงู Application

ูโุจุงุดุฏุ ุจูโุทูุฑ ฺฉู API ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ูพุฑูฺูโูุง ูุงูุน ู Production-ready ููุงุณุจ ุงุณุช.

---

## ๐งฑ ูุนูุงุฑ ูพุฑูฺู (Clean Architecture)

ุณุงุฎุชุงุฑ ฺฉู ูพุฑูฺู:


```
Api
 โโโ Controllers
      โโโ REST Endpoints

Application
 โโโ Interfaces
 โ   โโโ IUserContext
 โโโ Features
 โ   โโโ Appointment
 โ   โโโ User
 โ   โโโ Service
 โโโ DTOs
 โโโ Application Services

Infrastructure
 โโโ Security
 โ   โโโ JWT
 โ   โโโ UserContext
 โโโ Persistence
```

โ ูุงู `Application` ูุณุชูู ุงุฒ `Api` ู `Infrastructure` ุงุณุช  
โ ูฺ ููุทู ุงููุช ุญุงุช ุตุฑูุงู ุฏุฑ Controllerูุง ูุฑุงุฑ ูุฏุงุฑุฏ

---

## ๐ ุงุญุฑุงุฒ ููุช (JWT Authentication)

### JWT
- ุงุญุฑุงุฒ ููุช ฺฉุงุฑุจุฑุงู ุจุง **JSON Web Token**
- ุงุฑุณุงู Token ุฏุฑ Header ุฏุฑุฎูุงุณุช:
```
Authorization: Bearer {token}
```

### UserContext
ุจุฑุง ุญุฐู ูุงุจุณุชฺฏ ุจู `userId` ุงุฑุณุงู ุงุฒ ฺฉูุงูุช:

- Interface: `IUserContext` ุฏุฑ ูุงู Application
- Implementation: `UserContext` ุฏุฑ Infrastructure
- ุงุณุชุฎุฑุงุฌ ุงุทูุงุนุงุช ุงุฒ JWT Claims:
  - `UserId` โ `sub` ุง `ClaimTypes.NameIdentifier`
  - `Role` โ `ClaimTypes.Role`

โ ุชูุงู ุนููุงุช ูุงุจุณุชู ุจู ฺฉุงุฑุจุฑุ ููุช ุฑุง ุงุฒ JWT ูโฺฏุฑูุฏุ ูู ุงุฒ ูุฑูุฏ ฺฉูุงูุช.

---

## ๐ก๏ธ Authorization ู Role Management

### EnsureAdmin
ุจุฑุง ุนููุงุช Admin-onlyุ ูุชุฏ ุฒุฑ ุฏุฑ AppServiceูุง ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช:

```csharp
EnsureAdmin();
```

ุงู ูุชุฏ:
- Role ฺฉุงุฑุจุฑ ุฌุงุฑ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ
- ุฏุฑ ุตูุฑุช ุนุฏู ุฏุณุชุฑุณุ Exception ูพุฑุชุงุจ ูโฺฉูุฏ

โ ุญุช ุงฺฏุฑ Controller ุงุดุชุจุงู ูพฺฉุฑุจูุฏ ุดูุฏุ  
ูุงู Application ููฺูุงู ุงููุช ุฑุง ุญูุธ ูโฺฉูุฏ (**Defense in Depth**).

---

## ๐ค ุจุฑุฑุณ ูุงูฺฉุช (Ownership Check)

ุจุฑุง ุนููุงุช ุญุณุงุณ ฺฉุงุฑุจุฑูุญูุฑ ูุงููุฏ:
- ูุฑุงุด ููุจุช
- ูุบู ููุจุช
- ูุดุงูุฏู ููุจุชโูุง ุดุฎุต

ูุงูฺฉุช ุจุฑุฑุณ ูโุดูุฏ:

```
appointment.UserId == CurrentUserId
```

โ ูฺ ฺฉุงุฑุจุฑ ุจู ููุงุจุน ฺฉุงุฑุจุฑุงู ุฏฺฏุฑ ุฏุณุชุฑุณ ูุฏุงุฑุฏ.

---

## ๐ Appointment API

### ูุงุจูุชโูุง
- ุงุฌุงุฏ ููุจุช
- ูุฑุงุด ุฌุฒุฆ ููุจุช (PATCH)
- ูุบู ููุจุช
- ูุดุงูุฏู ููุจุชโูุง ุดุฎุต (JWT-Based)
- ูุดุงูุฏู ุชูุงู ููุจุชโูุง (Admin)

### Endpointูุง
```
POST    /api/appointment
PATCH   /api/appointment/{id}
DELETE  /api/appointment/{id}
GET     /api/appointment/my
GET     /api/appointment        (Admin only)
```

---

## ๐ฅ User API

### ุงูฺฉุงูุงุช
- ุซุจุชโูุงู ู ูุฑูุฏ
- ุฏุฑุงูุช ูพุฑููุงู ฺฉุงุฑุจุฑ ุฌุงุฑ
- ูุฑุงุด ูพุฑููุงู
- ุชุบุฑ ุฑูุฒ ุนุจูุฑ
- ุญุฐู ุญุณุงุจ ฺฉุงุฑุจุฑ
- ูุดุงูุฏู ูุณุช ฺฉุงุฑุจุฑุงู (Admin)

### Endpointูุง
```
POST   /api/user/register
POST   /api/user/login
POST   /api/user/refresh
GET    /api/user/me
PATCH  /api/user/me
POST   /api/user/change-password
DELETE /api/user/me
GET    /api/user               (Admin only)
```

---

## ๐ ุงุตูู REST ุฑุนุงุชโุดุฏู
- โ ุงุณุชูุงุฏู ุตุญุญ ุงุฒ HTTP Verbs
- โ Resource-based URL
- โ ุญุฐู Action-based Routeูุง
- โ ุงุณุชูุงุฏู ุงุฒ `me` ุจูโุฌุง ุงุฑุณุงู userId
- โ ุนุฏู ุฏุฑุงูุช ุงุทูุงุนุงุช ููุช ุญุณุงุณ ุงุฒ ฺฉูุงูุช

---

## ๐งช ูุชุฏูุง HTTP

| Method | ฺฉุงุฑุจุฑุฏ |
|------|------|
| GET | ุฏุฑุงูุช ุงุทูุงุนุงุช |
| POST | ุงุฌุงุฏ Resource |
| PATCH | ูุฑุงุด ุฌุฒุฆ |
| DELETE | ุญุฐู / ูุบู |

---

## โ๏ธ ุชฺฉููููฺโูุง
- ASP.NET Core
- JWT Authentication
- Clean Architecture
- Entity Framework Core
- FluentValidation

---

## ๐ ุงุฌุฑุง ูพุฑูฺู
```bash
dotnet restore
dotnet run
```

---
## โ๏ธ ูุถุนุช ุชูุณุนู ู ูฺฉุงุช ููู

ุงู ูพุฑูฺู ุฏุฑ ุญุงู ุญุงุถุฑ **ูุณุฎูโ ุงููู (v1)** ูุญุณูุจ ูโุดูุฏ.

ุจุง ูุฌูุฏ ุงูฺฉู:
- ุณุงุฎุชุงุฑ ูุนูุงุฑ ุจูโุตูุฑุช ุงุตูู (Clean Architecture) ุทุฑุงุญ ุดุฏู
- ููุงุญุธุงุช ุงููุช (JWTุ Authorizationุ Ownership Check) ุฑุนุงุช ุดุฏู
- API ุงุฒ ูุธุฑ RESTful ู Business Logic ูพุงุฏุงุฑ ุงุณุช

ููฺฉู ุงุณุช:
- ๐ ุจุงฺฏโูุง ููุทู ุง ูุจูโุง (Edge Case) ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ
- ๐ ุจุฑุฎ ุจุฎุดโูุง ุฏุฑ ุขูุฏู Refactor ุง ุจูููโุณุงุฒ ุดููุฏ
- โ ูุงุจูุชโูุง ุฌุฏุฏ ุง ุชุบุฑ ุฏุฑ Endpointูุง ุงุถุงูู ุดูุฏ

โ ูพุฑูฺู ุจูโุตูุฑุช **Active Development** ูฺฏูุฏุงุฑ ูโุดูุฏ ู  
ุฏุฑ ุจุงุฒูโูุง ุฒูุงู ูุฎุชูู ุจูโุฑูุฒุฑุณุงู ุฎูุงูุฏ ุดุฏ.

> ูุฏู ุงู ูุณุฎูุ ุงุฑุงุฆูโ ฺฉ ูพุงูโ ุชูุฒุ ุงูู ู ูุงุจู ุชูุณุนู ุจุฑุง ุงุฏุงููโ ูุณุฑ ุงุณุช.
 

